<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { appendChildrenToParent, createElement } from '../src/utils/dom';
import {
  getLocalStroage,
  getSessionStroage,
  setSessionStroage,
} from '../src/utils/storage';
import { HomeArticles, HomeFeed, HomeTagList } from '../src/components/Home';
import LoadingSpinner from '../src/commons/LoadingSpinner';

// pnpm deploy test
/**
 * Represents a login form component.
 * @function LoginForm
 */

function LoginForm() {
  /**
   * @type {Element}
   */
  const col = document.querySelector('.offset-md-3');

  /**
   * @type {Element}
   */
  const loginFormBox = createElement('form', 'form');
  appendChildrenToParent(col, loginFormBox);

  /**
   * @type {Object}
   * @property {string} email
   * @property {string} password
   */
  const initialState = {
    email: '',
    password: '',
  };

  /**
   * @function updateState LoginForm
   * @param {string} key email
   * @param {string} value password
   */
  const updateState = (key, value) => {
    state[key] = value;
  };

  /**
   * @function
   * @param {HashChangeEvent&lt;HTMLInputElement>} e
   */
  const handleChange = (e) => {
    const { name, value } = e.target;
    updateState(name, value);
  };

  /**
   * @function
   * @param {FormDataEvent} e
   * @returns {Promise&lt;void>}
   */
  const handleLoginSubmit = async (e) => {
    e.preventDefault();

    /**
     * @type {Object}
     * @property {string} email
     * @property {string} password
     */
    const loginData = {
      ...state,
    };

    /**
     * @param {Object} loginData
     * @param  {string} loginData.username
     * @param  {string} loginData.password
     * @returns {Promise&lt;string>} token
     * @throws {Error}
     */
    const token = await auth_request.userLogin(loginData);
    setLocalStroage('token', token);

    const authToken = await fetchAuthUserInfo(getLocalStroage('token'));

    setCookie('authToken', JSON.stringify(authToken), 7);
    if (token) {
      route('/');
    }
  };

  const render = () => {
    /**
     * @typedef {Object} Login Items
     * @property {string} placeholder placeholder
     * @property {string} name name
     * @property {string} type type
     * @property {string} id id
     * @property {string} className className
     */

    /** @type {Item[]} */
    const items = [
      {
        placeholder: 'Email',
        name: 'email',
        type: 'text',
        id: 'email',
        className: 'form-control form-control-lg',
      },
      {
        placeholder: 'Password',
        name: 'password',
        type: 'password',
        id: 'password',
        className: 'form-control form-control-lg',
      },
    ];

    /**
     * @param {Array&lt;Object>} items
     * @param {string} inputs.placeholder
     * @param {string} input.name
     * @param {string} input.type
     * @param {string} input.id
     * @param {string} input.className
     * @param {string} input.value
     * @returns {string}
     */
    const getInputField = createInputFields(items);

    loginFormBox.innerHTML = getInputField + buttonLogin;
    /**
     *
     * @param {HTMLInputElement} input
     */
    const inputs = document.querySelectorAll('input');
    inputs.forEach((input) => {
      input.addEventListener('change', handleChange);
    });

    const form = document.querySelector('.form');
    form.addEventListener('submit', handleLoginSubmit);
  };

  /**
   * @type {Object}
   */
  const state = initialState;

  render();

  return { state, handleChange };
}

///////////////////////////////////////////////////////////////////////////////////////////

/**
 * Represents a register form component.
 * @function RegisterForm
 */

function RegisterForm() {
  /**
   * @type {Element}
   */
  const col = document.querySelector('.offset-md-3 ');
  const registerFormBox = createElement('form', 'form');

  appendChildrenToParent(col, registerFormBox);

  /**
   * @type {Object}
   * @property {string} username
   * @property {string} email
   * @property {string} password
   */
  const initialState = {
    username: '',
    email: '',
    password: '',
  };

  /**
   * @function updateState RegisterForm
   * @param {string} key username,email,password
   * @param {string} value username,email,password
   */
  const updateState = (key, value) => {
    state[key] = value;
  };

  /**
   * @function
   * @param {HashChangeEvent&lt;HTMLInputElement>} e
   */
  const handleChange = (e) => {
    const { name, value } = e.target;
    updateState(name, value);
  };

  /**
   * @function
   * @param {FormDataEvent} e
   * @returns {Promise&lt;void>}
   */
  const handleRegisterSubmit = async (e) => {
    e.preventDefault();

    /**
     * @type {Object}
     * @property {string} username
     * @property {string} email
     * @property {string} password
     */
    const registerData = {
      ...state,
    };

    /**
     * @param {Object} registerData
     * @param  {string} registerData.username
     * @param  {string} registerData.username
     * @param  {string} registerData.password
     * @returns {Promise&lt;Object>} user
     * @throws {Error}
     */
    const user = await auth_request.userRegister(registerData);
    if (user) {
      route('/');
    }
  };

  /**
   * @returns {void}
   */
  const render = () => {
    /**
     * @typedef {Object} Register Items
     * @property {string} placeholder placeholder
     * @property {string} name name
     * @property {string} type type
     * @property {string} id id
     * @property {string} className className
     */

    /** @type {Item[]} */
    const items = [
      {
        placeholder: 'Username',
        name: 'username',
        type: 'text',
        id: 'username',
        className: 'form-control form-control-lg',
      },
      {
        placeholder: 'Email',
        name: 'email',
        id: 'email',
        type: 'text',
        className: 'form-control form-control-lg',
      },
      {
        placeholder: 'Password',
        name: 'password',
        id: 'password',
        type: 'password',
        className: 'form-control form-control-lg',
      },
    ];

    /**
     * @param {Array&lt;Object>} items
     * @param {string} inputs.placeholder
     * @param {string} input.name
     * @param {string} input.type
     * @param {string} input.id
     * @param {string} input.className
     * @returns {string}
     */
    const getInputFiled = createInputFields(items);

    registerFormBox.innerHTML = getInputFiled + buttonRegister;

    /**
     * @type {Element}
     */
    const inputs = document.querySelectorAll('input');
    /**
     * @param {HTMLInputElement} input
     */
    inputs.forEach((input) => {
      input.addEventListener('change', handleChange);
    });

    const form = document.querySelector('.form');
    form.addEventListener('submit', handleRegisterSubmit);
  };

  /**
   * @type {Object}
   */
  const state = initialState;
  render();

  return { handleChange, state };
}
///////////////////////////////////////////////////////////////////////////////////////////

/**
 * Represents a HomeMain form component.
 * @component HomeMain
 */

function HomeMain() {
  /**
   * Renders main  for home page.
   * @returns {void}
   */
  renderHomeMain();

  /**
   * @function
   * @param {MouseEvent&lt;HTMLButtonElement>} e
   */
  const handleTagListClick = (e) => {
    if (e.target.classList.contains('tag-pill')) {
      /**
       * @type {Element}
       */
      const tag = e.target.textContent.trim();

      /**
       * @param {string} key
       * @param {Element} tag
       */
      setSessionStroage('selectTag', tag);

      updateState({
        activeFeed: 'getTag',
      });
      render();
    }
  };

  /**
   * @function
   * @param {MouseEvent&lt;HTMLButtonElement>} e
   */
  const handleFeedClick = async (e) => {
    e.preventDefault();

    /**
     * @param {string} key
     * @returns {unknown | string}
     */
    const getTag = getSessionStroage('selectTag');

    /**
     * @type {Element}
     */
    const textContent = e.target.textContent.trim();

    /**
     * @typedef {Object} HomeMain feeds
     * @property {unknown | string} text text
     * @property {string} feed feed
     */
    /** @type {feeds[]} */
    const feeds = [
      { text: 'Global Feed', feed: 'global' },
      { text: `#${getTag &amp;&amp; getTag.trim()}`, feed: 'getTag' },
      { text: 'Your Feed', feed: 'your' },
    ];

    const findFeed = feeds.find((feed) => feed.text === textContent);

    if (findFeed) {
      updateState({ activeFeed: findFeed.feed });
    }
    render();
  };

  const render = async () => {
    /**
     * Retrieves articles as  Promise.
     * @returns {Promise&lt;articles[]>}
     */
    const articlesPromise = getArticlesPromise();

    /**
     * @component HomeFeed
     * @param {string} activeFeed
     * @param {Function} onClick
     */
    HomeFeed({
      activeFeed: state.activeFeed,
      onClick: handleFeedClick,
    });

    /**
     * @component HomeArticles
     * @param {string[]} articles
     */
    HomeArticles({
      articles: [],
    });

    const spinner = LoadingSpinner();
    const col = document.querySelector('.col-md-9');
    col.appendChild(spinner);
    await articlesPromise;

    /**
     * @component HomeArticles
     * @param {string[]} pageNumber
     * @param {articles[]} articles
     * @param {function} onClick
     */
    HomeArticles({
      pageNumber: state.pageNumber,
      articles: state.articles,
      onClick: handleTagListClick,
    });
  };

  render();

  const initTags = () => {
    /**
     * @component HomeTagList
     * @param {function} onClickFeed
     * @param {function} onClickTag
     */
    HomeTagList({
      onClickFeed: handleFeedClick,
      onClickTag: handleTagListClick,
    });
  };

  initTags();

  return { render };
}

///////////////////////////////////////////////////////////////////////////////////////////
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#HomeMain">HomeMain</a></li><li><a href="global.html#LoginForm">LoginForm</a></li><li><a href="global.html#RegisterForm">RegisterForm</a></li><li><a href="global.html#updateStateLoginForm">updateState LoginForm</a></li><li><a href="global.html#updateStateRegisterForm">updateState RegisterForm</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Mon Jul 03 2023 16:41:03 GMT+0900 (대한민국 표준시)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
